{% extends "base.html" %}
{% block title %}Time Adjustment Review - {{ guild_name }}{% endblock %}

{% block head %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}">
{% endblock %}

{% block content %}
<div class="dashboard-container">
    <div class="dashboard-header">
        <div>
            <h1><span style="color: #D4AF37;">â³</span> Time Adjustment Requests</h1>
            <p style="color: #8B949E; margin-top: 8px;">{{ guild_name }}</p>
        </div>
        <a href="/dashboard?guild={{ guild_id }}" class="btn btn-secondary" style="height: fit-content;">
            â† Back to Dashboard
        </a>
    </div>

    <!-- Pending Requests Section -->
    <div class="tile" style="margin-top: 20px;">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
            <h2>
                <span class="tile-icon">ğŸ“‹</span>
                Pending Requests
                <span id="pending-count-badge" class="count-badge" style="display: none;">0</span>
            </h2>
        </div>
        <div id="pending-requests-container">
            <div style="text-align: center; padding: 40px; color: #8B949E;">
                <div style="font-size: 24px; margin-bottom: 10px;">â³</div>
                <div>Loading pending requests...</div>
            </div>
        </div>
    </div>

    <!-- Past Requests Section -->
    <div class="tile" style="margin-top: 20px;">
        <h2>
            <span class="tile-icon">ğŸ“œ</span>
            Recently Reviewed
        </h2>
        <div id="past-requests-container">
            <div style="text-align: center; padding: 40px; color: #8B949E;">
                <div>Loading recent requests...</div>
            </div>
        </div>
    </div>
</div>

<!-- Deny Reason Modal -->
<div id="deny-modal" class="modal-overlay" style="display: none;">
    <div class="modal-content" style="max-width: 500px;">
        <div class="modal-header">
            <h3>âŒ Deny Request</h3>
            <button class="close-modal" onclick="closeDenyModal()">&times;</button>
        </div>
        <div class="modal-body">
            <p style="color: #C9D1D9; margin-bottom: 15px;">Please provide a reason for denying this request. The
                employee will see this explanation.</p>
            <textarea id="denial-reason" rows="4" placeholder="Explain why this request is being denied..."
                style="width: 100%; padding: 12px; background: rgba(0,0,0,0.3); border: 1px solid rgba(75,85,99,0.4); border-radius: 6px; color: #C9D1D9; font-family: inherit; resize: vertical;"></textarea>
        </div>
        <div class="modal-footer">
            <button class="btn-secondary" onclick="closeDenyModal()">Cancel</button>
            <button class="btn-primary" onclick="submitDenial()"
                style="background: rgba(239, 68, 68, 0.2); border-color: #EF4444; color: #EF4444;">
                Submit Denial
            </button>
        </div>
    </div>
</div>

<script src="{{ url_for('static', filename='js/server-adjustments.js') }}"></script>
<script>
    // Initialize page with guild context
    const guildId = "{{ guild_id }}";
    const guildName = "{{ guild_name }}";

    // Start loading data
    initializeAdjustmentsReview(guildId);
</script>
{% endblock %}